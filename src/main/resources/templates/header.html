<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Header</title>

<!-- <style> -->

<!-- </style> -->
<link rel="stylesheet" type="text/css" href="/css/header.css">
<link rel="stylesheet" href="/css/chatContainer.css" />
</head>
<body>
	<header th:fragment="header">
		<div id="header-content" style="display: flex; position: relative;">
				<div style="margin-right:10px;" >
			<a href="/"  ><img src="/logo/logo.jpg" width=80%, height=50px style="margin-top:5px;" ></a>
			</div>
			<!-- ë¡œê·¸ì¸ ìƒíƒœì¸ ê²½ìš° -->
			<div th:if="${isLoggedIn}" class="logged-in">
				<input type="hidden" th:value="${isLoggedIn}" id="isLoggedIn">
				<input type="hidden" th:value="${id}" id="loggedId"> <input
					type="hidden" th:value="${loggedUserId}" id="loggedUserId">
				<input type="hidden" th:value="${address}" id="loggedAddress">
							<input type="hidden" th:value="${loggedNickname}" id="loggedNickname">
			
					

				<div
					style="display: flex; justify-content: space-between; width: 100%;">
					<!-- ê²Œì‹œíŒ ë§í¬ (ì™¼ìª½ ì •ë ¬) -->

					<div style="display: flex; justify-content: flex-start; gap: 10px;">
						<a href="/" style="flex-grow: 0;">í™ˆ</a> <a href="/board/list"
							th:href="@{|/board/list?condition=3|}" style="flex-grow: 0;">ê²Œì‹œíŒ</a>
						<!-- 					th:id="|mainImage-${board.id}|" -->
						<a href="/board/writeboard">ê¸€ì“°ê¸°</a>
					</div>
					<!-- ë‚˜ë¨¸ì§€ ë§í¬ë“¤ (ì˜¤ë¥¸ìª½ ì •ë ¬) -->
					<div style="display: flex; justify-content: flex-end; gap: 10px;">
						<a th:href="@{/mypage/{id}(id=${id})}" style="display: flex;">
							<img
							th:src="${profileImage != null ? profileImage:'/boardimage/nullimage.jpg'}"
							alt="profile image"
							style="display: block; width: 30px; height: 30px; object-fit: cover; margin-right: 5px; margin-top: -3px;">
							<span> <span style="margin-top:5px;" th:text="${loggedNickname}"></span>
						</span>
						</a> <a th:href="@{/logout}" style="margin-left: 10px;">ë¡œê·¸ì•„ì›ƒ</a> <a
							th:href="@{/mypage/{id}(id=${id})}">ë§ˆì´í˜ì´ì§€</a>
						<!-- 						<a th:href="@{/trade/mytrade/{id}(id=${id})}">ê±°ë˜ëª©ë¡</a> -->
						<!-- 						<a th:href="@{/trade/myfavorite/{id}(id=${id})}">ê´€ì‹¬ëª©ë¡</a> -->
						<!-- ë‚˜ì˜ ì±„íŒ…ë°© ë²„íŠ¼ -->
						<a href="#" id="myChattingRoomList"
							style="position: relative; display: inline-block;"> <img
							src="/icon/comment.png" alt="ë‚˜ì˜ ì±„íŒ…ë°©" width="20" height="20"
							style="margin-top: 1px;"> <span
							id="unReadMessageCountButton">0</span>
						</a>

						<!-- ì•Œë¦¼ ë²„íŠ¼ -->
						<div class="alarm-container">
							<button type="button" id="alarmButton"
								style="position: relative;">
								<div style="display: flex;">
									<img src="/icon/bell.png" alt="ì•Œë¦¼" width="20" height="20" /> <span
										id="unReadAlarmCountButton">3</span>
								</div>
							</button>
						</div>
					</div>
				</div>



				<div style="display: flex; position: relative;">
					<!-- ì±„íŒ…ë°© ë¦¬ìŠ¤íŠ¸ (ì˜¤ë¥¸ìª½ ì •ë ¬, í•˜ë‚˜ë§Œ í™œì„±í™”ì‹œ ê¸°ë³¸ ìœ„ì¹˜) -->
					<div class="chattingRoomList"
						style="position: absolute; top: -5px; left: 0px; width: 600px; height: 650px; display: none; z-index: 1;"
						onclick="bringToFront(this)">
						<!-- ğŸ” ê²€ìƒ‰ì°½ ì¶”ê°€ -->
						<input type="text" id="chatSearch" placeholder="ì±„íŒ…ë°© ê²€ìƒ‰..."
							style="width: 100%; padding: 8px; box-sizing: border-box; margin-bottom: 5px;">
						<h3 id="searchResultText" style="display: none;">ê²€ìƒ‰ ê²°ê³¼ (ì±„íŒ…ë°©)
						</h3>
						<div style ="display:flex;justify-content: space-between;margin:10px;" >
							 <label><input type="checkbox" id ="read-all-messages"  style="margin-right:5px;">ëª¨ë‘ ì½ìŒ</label>
						 <label><input type="checkbox" id ="exceptTrade" style="margin-right:5px;">ê±°ë˜ë¶ˆê°€,ê±°ë˜ì™„ë£Œ ì œì™¸ </label>
						
						</div>
						<div id="chattingRoomScroll">
							<table>
								<tbody id="chattingRoomListBody">
									<!-- ì±„íŒ…ë°© ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
								</tbody>
							</table>
							<div id="messagedata" style="display: none;"></div>
						</div>
					</div>
					<!-- ì•Œë¦¼ ë¦¬ìŠ¤íŠ¸ (ì˜¤ë¥¸ìª½ ì •ë ¬, í•˜ë‚˜ë§Œ í™œì„±í™”ì‹œ ê¸°ë³¸ ìœ„ì¹˜) -->
					<div class="alarmList"
						style="position: absolute; top: -5px; right: 0; width: 600px; height: 670px; display: none; z-index: 1;"
						onclick="bringToFront(this)">
						<table>
							<tbody id="alarmListBody">
									<div style ="display:flex;justify-content: space-between;margin:10px;" >
								<div id="notification-container"></div>
								<!-- ëª¨ë“  ì•Œë¦¼ ì‚­ì œ ë²„íŠ¼ -->
								<button id="deleteAllAlarmsBtn" class="small-btn">ëª¨ë“  ì•Œë¦¼ ì‚­ì œ</button>
								</div>
								<!-- ì•Œë¦¼ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
							</tbody>
						</table>
					</div>
				</div>




			</div>
			<!-- ê¸°ë³¸ ì œëª© í‘œì‹œ -->
<!-- 			<h1 th:text="${title}">ê¸°ë³¸ ì œëª©</h1> -->


			<!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœì¸ ê²½ìš° -->
			<div th:if="${!isLoggedIn}" class="logged-in">
				<div
					style="display: flex; justify-content: space-between; width: 100%;margin-top:-10px;">
					<div style="display: flex; justify-content: flex-start; gap: 10px;">

						<a href="/" style="flex-grow: 0;">í™ˆ</a>
						<!-- 			 <a th:href="@{/findid}">ì•„ì´ë”” ì°¾ê¸°</a> <a -->
						<!-- 					th:href="@{/findpassword}">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a> -->
						<a href="/board/list">ê²Œì‹œíŒ</a>
						<!-- 				<a href="/board/writeboard">ê¸€ì“°ê¸°</a> -->
					</div>
					<div style="display: flex; justify-content: flex-end; gap: 10px;">
						<a th:href="@{/formlogin}">ë¡œê·¸ì¸</a> <a th:href="@{/join}">íšŒì›ê°€ì…</a>
					</div>
				</div>
			</div>
			</div>
	</header>




	<script src="/js/state.js" type="module"></script>
	<script src="/js/headerUI.js" type="module"></script>

	<script>
    function bringToFront(element) {
        // ëª¨ë“  ìš”ì†Œì˜ z-indexë¥¼ 1ë¡œ ë¦¬ì…‹
        const allElements = document.querySelectorAll('.chattingRoomList, .alarmList, .modal-content');
        allElements.forEach(el => {
            if (el.style.display !== "none") {  // displayê°€ "none"ì´ ì•„ë‹ ë•Œë§Œ z-index ë³€ê²½
                el.style.zIndex = '1';
            }
        });

        // í´ë¦­í•œ ìš”ì†Œê°€ ë³´ì´ë©´ z-indexë¥¼ 10ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì•ì— ë³´ì´ê²Œ í•¨
        if (element.style.display !== "none") {
            element.style.zIndex = '10';
        }
    }
</script>

<script>
// document.addEventListener('DOMContentLoaded', () => {
//     const exceptTrade = document.querySelector('#exceptTrade'); // ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒ
//     const loggedId = document.getElementById("loggedId").value;
//         const loggedUserId = document.getElementById("loggedUserId").value;
//     // ì²´í¬ë°•ìŠ¤ ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
//     exceptTrade.addEventListener('change', async () => {
//         // ì²´í¬ë°•ìŠ¤ê°€ ì²´í¬ë˜ì§€ ì•Šì•˜ì„ ë•Œ
//         if (exceptTrade.checked === false) {
//             // ì²´í¬ë°•ìŠ¤ë¥¼ ë‹¤ì‹œ ì²´í¬ ìƒíƒœë¡œ ë§Œë“¤ê¸°
//             exceptTrade.checked = true;

//             // ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì²´í¬ ìƒíƒœ ì €ì¥
//             sessionStorage.setItem("exceptTradeChecked", exceptTrade.checked);
// //        					await loadChatRooms(loggedId);
// //						setUpEnterRoomButton(loggedUserId);
// //						setUpExitRoomButton();
            
//         } else {
//             // ì²´í¬ë°•ìŠ¤ë¥¼ ì²´í¬í–ˆì„ ë•Œ ìƒíƒœë¥¼ ê·¸ëŒ€ë¡œ ì €ì¥
//             sessionStorage.setItem("exceptTradeChecked", exceptTrade.checked);
//         }
//     });
// });

</script>


</body>
</html>
